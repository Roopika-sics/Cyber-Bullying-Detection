{% extends "base.html" %}
{% block title %}Post List{% endblock %}
{% block content %}

<div class="header w-full text-right  mt-2">
    <a class="btn bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded mr-2" href="{% url 'logout' %}">logout</a>
</div>
<div class="max-w-2xl mx-auto mt-10 space-y-6">
    {% for post in posts %}
    <div class="bg-gray-900 text-white rounded-lg shadow-lg p-4">

        <div class="flex items-center space-x-3">
            <div class="bg-gray-700 w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold">
                {{ post.user.username.0|upper }}
            </div>
            <p class="text-lg font-semibold">{{ post.user.username }}</p>
        </div>

        <p class="mt-3 text-gray-300">{{ post.content }}</p>

        {% if post.image %}
            <img src="{{ post.image.url }}" class="mt-3 rounded-lg w-full h-auto object-cover">
        {% endif %}

        <div class="mt-4 flex items-center space-x-3">
            <button class="like-btn bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-white font-semibold"
                data-post-id="{{ post.id }}">
                {% if post.is_liked_by_user %}
                    Unlike
                {% else %}
                    Like
                {% endif %}
            </button>
            <span id="likes-count-{{ post.id }}" class="text-gray-300">{{ post.likes.count }}</span> Likes
        </div>

        <form class="comment-form mt-2" data-post-id="{{ post.id }}">
            {% csrf_token %}
            <input type="text" name="text" placeholder="Add a comment"
                class="px-2 py-1 rounded border border-gray-300 comment-input">
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-1 rounded">
                Comment
            </button>
        </form>

        <div class="comments-list mt-2" id="comments-list-{{ post.id }}">
            {% for comment in post.comments.all %}
                <p class="text-gray-300 mt-1"><strong>{{ comment.user.username }}</strong>: {{ comment.text }}</p>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
</div>

{% endblock %}
